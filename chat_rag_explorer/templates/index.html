<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Chat RAG Explorer</title>
        <link rel="stylesheet" href="/static/style.css" />
    </head>
    <body>
        <div class="main-layout">
            <div class="app-container">
                <header>
                    <div class="header-content">
                        <h1>Chat RAG Explorer</h1>
                        <div class="header-actions">
                            <button id="clear-chat-btn" class="icon-btn" title="Clear chat">&#8635;</button>
                            <a href="/settings" class="icon-btn" title="Settings">&#9881;</a>
                        </div>
                    </div>
                </header>
                
                <div id="chat-history" class="chat-history">
                    <!-- Messages will appear here -->
                </div>

                <div class="input-area">
                    <form id="chat-form">
                        <input
                            type="text"
                            id="message-input"
                            placeholder="Type your message..."
                            autocomplete="off"
                        />
                        <button type="submit">Send</button>
                    </form>
                </div>
            </div>

            <aside class="sidebar">
                <div class="sidebar-section">
                    <div class="metric">
                        <span class="label">Model:</span>
                        <span id="metric-model" class="value">-</span>
                    </div>
                </div>
                <div class="sidebar-section">
                    <h3>Last Interaction</h3>
                    <div class="metric">
                        <span class="label">Prompt Tokens:</span>
                        <span id="metric-prompt-tokens" class="value">0</span>
                    </div>
                    <div class="metric">
                        <span class="label">Completion Tokens:</span>
                        <span id="metric-completion-tokens" class="value">0</span>
                    </div>
                    <div class="metric">
                        <span class="label">Total Tokens:</span>
                        <span id="metric-total-tokens" class="value">0</span>
                    </div>
                </div>
                <div class="sidebar-section">
                    <h3>Session Totals</h3>
                    <div class="metric">
                        <span class="label">Total Prompt:</span>
                        <span id="total-prompt-tokens" class="value">0</span>
                    </div>
                    <div class="metric">
                        <span class="label">Total Completion:</span>
                        <span id="total-completion-tokens" class="value">0</span>
                    </div>
                    <div class="metric">
                        <span class="label">Total Tokens:</span>
                        <span id="total-total-tokens" class="value">0</span>
                    </div>
                </div>
                <div class="sidebar-section">
                    <h3>Parameters</h3>
                    <div class="param-control" id="temperature-control">
                        <div class="param-header">
                            <label for="temperature-slider">
                                <span class="tooltip-wrapper">
                                    <span class="help-icon">?</span>
                                    <span class="tooltip-content">Controls randomness. Lower = focused. Higher = creative. <a href="https://openrouter.ai/docs/api/reference/parameters#temperature" target="_blank" rel="noopener">Learn more</a></span>
                                </span>
                                Temperature
                            </label>
                            <span id="temperature-value" class="param-value">1.0</span>
                        </div>
                        <input type="range" id="temperature-slider" min="0" max="2" step="0.1" value="1.0">
                        <span class="param-hint" id="temperature-hint"></span>
                    </div>
                    <div class="param-control" id="top-p-control">
                        <div class="param-header">
                            <label for="top-p-slider">
                                <span class="tooltip-wrapper">
                                    <span class="help-icon">?</span>
                                    <span class="tooltip-content">Nucleus sampling. 0.1 = top 10% tokens. Alter this OR temperature, not both. <a href="https://openrouter.ai/docs/api/reference/parameters#top-p" target="_blank" rel="noopener">Learn more</a></span>
                                </span>
                                Top P
                            </label>
                            <span id="top-p-value" class="param-value">1.0</span>
                        </div>
                        <input type="range" id="top-p-slider" min="0" max="1" step="0.05" value="1.0">
                        <span class="param-hint" id="top-p-hint"></span>
                    </div>
                </div>
            </aside>
        </div>

        <!-- Details Modal -->
        <div id="details-modal" class="modal-overlay">
            <div class="modal details-modal">
                <div class="details-modal-header">
                    <h3>What the LLM Received</h3>
                    <button id="details-modal-close" class="modal-close-btn">&times;</button>
                </div>
                <div class="details-modal-body">
                    <div id="details-content"></div>
                </div>
            </div>
        </div>

        <script src="/static/marked.min.js"></script>

        <script src="/static/purify.min.js"></script>
        <script src="/static/script.js"></script>
    </body>
</html>
